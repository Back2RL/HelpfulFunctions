
DESCRIBE hr.employees;
SELECT * FROM hr.employees;

-- Aufgabe 7.3a
select hr.employees.first_name Vorname,
        hr.employees.last_name Nachname,
        hr.employees.phone_number Telefonnr,
        hr.employees.manager_id Manager
from HR.EMPLOYEES
where  (hr.employees.manager_id = 100
        or  hr.employees.manager_id = 108)    
        and (hr.employees.phone_number like '650%'
        or hr.employees.phone_number like '515%');
        
-- Aufgabe 7.3b        
select hr.employees.first_name Vorname,
        hr.employees.last_name Nachname,
        hr.employees.department_id Department,
        hr.employees.manager_id Manager
from hr.employees
where  hr.employees.commission_pct is not null
order by Department asc,
       Manager asc;
       
-- Aufgabe 7.3c       
select min(hr.employees.SALARY) Min,
        max(hr.employees.SALARY) Max,
        round(avg(hr.employees.SALARY)) Avg
from hr.employees; 

-- Aufgabe 7.3d 
select hr.employees.first_name Vorname,
        hr.employees.last_name Nachname,
        hr.employees.salary Gehalt
from hr.employees
where  hr.employees.department_id is null
        or hr.employees.manager_id is null
order by Gehalt desc;

-- Aufgabe 7.3e
select departments.department_id Department,
        a.first_name Vorname,
        a.last_name Nachname
from hr.employees a, hr.departments departments
where a.employee_id =  departments.manager_id
order by Department;

-- Aufgabe 7.3f
select a.first_name Vorname,
        a.last_name Nachname
from hr.employees a, hr.departments departments
where a.department_id = departments.department_id
and a.manager_id = departments.manager_id;

-- Aufgabe 7.3g
select a.first_name Vorname,
        a.last_name Nachname,
        b.first_name MVorname,
        b.last_name MNachname
from hr.employees a,hr.employees b
where a.manager_id = b.employee_id;
     
-- Aufgabe 7.3h
select a.first_name Vorname,
        a.last_name Nachname,
        a.salary Gehalt,
        b.first_name MVorname,
        b.last_name MNachname,
        b.salary MGehalt
from hr.employees a,hr.employees b
where a.manager_id = b.employee_id
and a.salary > b.salary;
           


